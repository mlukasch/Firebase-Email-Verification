angular.module("codeSide",["ui.router","firebase","ngProgress","ui.router.title"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,o,t){e.state("home",{url:"/",templateUrl:"home/home.html",controller:"HomeController",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]},meta:{title:"Homepage",description:"Your Favorite Programming Languages, Side By Side"}}).state("emailVerify",{url:"/verify-email?mode&oobCode",templateUrl:"auth/verify-email.html",controller:"emailVerifyController",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]},meta:{title:"Verify Email",description:"Email Verification"}}).state("signup",{url:"/register",templateUrl:"auth/register.html",controller:"LogRegController",meta:{title:"Sign up"}}).state("login",{url:"/login",templateUrl:"auth/login.html",controller:"LogRegController",params:{message:null,toWhere:null},meta:{title:"Login"}}).state("admin",{url:"/admin",templateUrl:"admin/admin.html",controller:"AdminController",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]},meta:{title:"Dashboard"}}),o.otherwise("/"),t.html5Mode(!0)}]).run(["$rootScope","$state","$location","Auth","ngProgressFactory",function(e,o,t,r,a){var n=a.createInstance();e.$on("$stateChangeError",function(e,t,r,a,i,l){"AUTH_REQUIRED"===l&&(o.go("login",{toWhere:t}),n.complete())}),e.$on("$stateChangeStart",function(e,o,t,r,a){n.start()}),e.$on("$stateChangeSuccess",function(){e.title=o.current.meta.title,e.description=o.current.meta.description,n.complete()})}]),angular.module("codeSide").controller("AdminController",["$scope","currentAuth",function(e,o){e.authInfo=o,e.sendVerifyEmail=function(){toastr.info("Sending email verification message to your email. Check inbox now!","Email Verification"),o.sendEmailVerification()}}]),angular.module("codeSide").controller("LogRegController",["$scope","$stateParams","Auth","$state","$rootScope","DatabaseRef","$firebaseObject",function(e,o,t,r,a,n,i){e.formData={},e.login=function(){e.formData.email||e.formData.password?t.$signInWithEmailAndPassword(e.formData.email,e.formData.password).then(function(e){null!==o.toWhere?(r.go(o.toWhere.name),o.toWhere=null):r.go("admin"),e.emailVerified||(toastr.info("Your email is NOT verified.","Verify email!"),r.go("admin"))})["catch"](function(o){toastr.error(o.message,o.reason,{timeOut:1e4}),e.formData={}}):toastr.error("Add email and password")},e.register=function(){e.formData.email&&e.formData.password&&e.formData.username?(console.log(e.formData.email,e.formData.password),t.$createUserWithEmailAndPassword(e.formData.email,e.formData.password).then(function(o){n.child("users").child(o.uid).set({username:e.formData.username,displayName:o.displayName||"",email:o.email}),toastr.info("Sending email verification link. Check email!","You've got mail!"),o.sendEmailVerification(),toastr.success("Awesome! Welcome aboard. Login to begin coding!","Register Successful",{timeOut:7e3}),r.go("admin")})["catch"](function(o){toastr.error(o.message,o.reason),e.formData={}})):toastr.error("Kindly complete the form","Some parts missing!")},e.googleAuth=function(){var e=new firebase.auth.GoogleAuthProvider;e.addScope("https://www.googleapis.com/auth/plus.login"),t.$signInWithPopup(e).then(function(e){var o=!1;"seanmavley@gmail.com"==e.user.email&&(o=!0),console.log(e.user);var t=i(n.child("users").child(e.user.uid));t.$loaded().then(function(r){t.$save({displayName:r.displayName||e.user.displayName,email:r.email||e.user.email,admin:r.admin||o,createdAt:(new Date).getTime()})}),toastr.success("Logged in with Google successfully","Success"),r.go("admin")})["catch"](function(e){toastr.error(e.message,e.reason)})},e.facebookAuth=function(){var e=new firebase.auth.FacebookAuthProvider;e.addScope("email"),t.$signInWithPopup(e).then(function(e){toastr.success("Logged in with Google successfully","Success"),r.go("home")})["catch"](function(e){toastr.error(e.message,e.reason)})}}]),angular.module("codeSide").controller("emailVerifyController",["$scope","$stateParams","currentAuth","DatabaseRef",function(e,o,t,r){console.log(t),e.doVerify=function(){firebase.auth().applyActionCode(o.oobCode).then(function(e){toastr.success("Verification happened","Success!")})["catch"](function(o){e.error=o.message,toastr.error(o.message,o.reason,{timeOut:0})})}}]),angular.module("codeSide").controller("MenuController",["$scope","Auth","$state",function(e,o,t){o.$onAuthStateChanged(function(o){null!=o?e.loggedIn=!0:e.loggedIn=!1}),e.logout=function(){o.$signOut(),o.$onAuthStateChanged(function(e){console.log("loggedout")}),t.go("login")}}]),angular.module("codeSide").controller("HomeController",["$scope","currentAuth",function(e,o){console.log(o.emailVerified),e.verified=o.emailVerified}]),angular.module("codeSide").factory("Auth",["$firebaseAuth",function(e){return e()}]),angular.module("codeSide").factory("DatabaseRef",function(){return firebase.database().ref()}),$(document).foundation(),toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};